<!doctype html><html lang=es class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Retos realizados a partir de una placa tipo Arduino UNO y la shield Imagina TdR-STEAM V2.0 y alguna teoría de la necesaria"><meta name=author content="Federico Coca"><link href=https://fgcoca.github.io/TdR-STEAM-and_UNO/R15/ rel=canonical><link rel=icon href=../img/favicon.png><meta name=generator content="mkdocs-1.2.3, mkdocs-material-8.1.9"><title>Reto-15. IoT (WiFi) - Retos con TdR-STEAM y keyestudio UNO</title><link rel=stylesheet href=../assets/stylesheets/main.2b4465f4.min.css><link rel=stylesheet href=../assets/stylesheets/palette.e6a45f82.min.css><meta name=theme-color content=#02a6f2><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><script>__md_scope=new URL("..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme data-md-color-primary=light-blue data-md-color-accent=deep-purple> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#reto-15-iot-wifi class=md-skip> Saltar a contenido </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Cabecera> <a href=.. title="Retos con TdR-STEAM y keyestudio UNO" class="md-header__button md-logo" aria-label="Retos con TdR-STEAM y keyestudio UNO" data-md-component=logo> <img src=../img/favicon.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Retos con TdR-STEAM y keyestudio UNO </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Reto-15. IoT (WiFi) </span> </div> </div> </div> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Búsqueda placeholder=Búsqueda autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" aria-label=Limpiar tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Inicializando búsqueda </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/fgcoca/TdR-STEAM-and_UNO title="Ir al repositorio" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> fgcoca/TdR-STEAM-and_UNO </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navegación data-md-level=0> <label class=md-nav__title for=__drawer> <a href=.. title="Retos con TdR-STEAM y keyestudio UNO" class="md-nav__button md-logo" aria-label="Retos con TdR-STEAM y keyestudio UNO" data-md-component=logo> <img src=../img/favicon.png alt=logo> </a> Retos con TdR-STEAM y keyestudio UNO </label> <div class=md-nav__source> <a href=https://github.com/fgcoca/TdR-STEAM-and_UNO title="Ir al repositorio" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> fgcoca/TdR-STEAM-and_UNO </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=.. class=md-nav__link> Introducción </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2 type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2> Algo de teoría <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Algo de teoría" data-md-level=1> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Algo de teoría </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../soft/ class=md-nav__link> Software </a> </li> <li class=md-nav__item> <a href=../hard/ class=md-nav__link> Hardware TdR STEAM </a> </li> <li class=md-nav__item> <a href=../3D/ class=md-nav__link> Elementos impresión 3D </a> </li> <li class=md-nav__item> <a href=../operadores/ class=md-nav__link> Operadores en programación C++ </a> </li> <li class=md-nav__item> <a href=../IoT_basico/ class=md-nav__link> Teoría básica de IoT </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3 type=checkbox id=__nav_3 checked> <label class=md-nav__link for=__nav_3> Colección de retos y actividades <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Colección de retos y actividades" data-md-level=1> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Colección de retos y actividades </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../R01/ class=md-nav__link> Reto-01. LED </a> </li> <li class=md-nav__item> <a href=../R02/ class=md-nav__link> Reto-02. LEDs rojo y azul </a> </li> <li class=md-nav__item> <a href=../R03/ class=md-nav__link> Reto-03. LED RGB </a> </li> <li class=md-nav__item> <a href=../R04/ class=md-nav__link> Reto-04. Zumbador </a> </li> <li class=md-nav__item> <a href=../R05/ class=md-nav__link> Reto-05. Pulsadores </a> </li> <li class=md-nav__item> <a href=../R06/ class=md-nav__link> Reto-06. Potenciómetro </a> </li> <li class=md-nav__item> <a href=../R07/ class=md-nav__link> Reto-07. Fotorresistencia LDR </a> </li> <li class=md-nav__item> <a href=../R08/ class=md-nav__link> Reto-08. Sensor de temperatura LM35 </a> </li> <li class=md-nav__item> <a href=../R09/ class=md-nav__link> Reto-09. Sensor de temperatura y humedad DHT-11 </a> </li> <li class=md-nav__item> <a href=../R10/ class=md-nav__link> Reto-10. Emisor y receptor de infrarrojos </a> </li> <li class=md-nav__item> <a href=../R11/ class=md-nav__link> Reto-11. Puerto de expansión I2C. La LCD de 2x16 </a> </li> <li class=md-nav__item> <a href=../R12/ class=md-nav__link> Reto-12. Sensor de sonido o micrófono </a> </li> <li class=md-nav__item> <a href=../R13/ class=md-nav__link> Reto-13. Termohigrómetro </a> </li> <li class=md-nav__item> <a href=../R14/ class=md-nav__link> Reto-14. Bluetooth </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> Reto-15. IoT (WiFi) <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> Reto-15. IoT (WiFi) </a> <nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Tabla de contenidos </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#enunciado class=md-nav__link> Enunciado </a> </li> <li class=md-nav__item> <a href=#teoria class=md-nav__link> Teoría </a> </li> <li class=md-nav__item> <a href=#en-la-tdr-steam class=md-nav__link> En la TdR STEAM </a> </li> <li class=md-nav__item> <a href=#programando-el-reto class=md-nav__link> Programando el reto </a> <nav class=md-nav aria-label="Programando el reto"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#thingspeak class=md-nav__link> Thingspeak </a> </li> <li class=md-nav__item> <a href=#arduinoblocks class=md-nav__link> ArduinoBlocks </a> </li> <li class=md-nav__item> <a href=#visualizacion-de-datos class=md-nav__link> Visualización de datos </a> </li> <li class=md-nav__item> <a href=#visualizacion-de-datos-en-smartphone-o-similar class=md-nav__link> Visualización de datos en smartphone o similar </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#actividades-de-ampliacion class=md-nav__link> Actividades de ampliación </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../retos/ class=md-nav__link> Todos los programas de los retos </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5 type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5> Miscelanea <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Miscelanea data-md-level=1> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Miscelanea </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../Miscelanea/about/ class=md-nav__link> Autor </a> </li> <li class=md-nav__item> <a href=../Miscelanea/lic/ class=md-nav__link> Licencias </a> </li> <li class=md-nav__item> <a href=../Miscelanea/webgrafia/ class=md-nav__link> Webgrafia/Bibliografía </a> </li> <li class=md-nav__item> <a href=../Miscelanea/soft/ class=md-nav__link> Software utilizado </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Tabla de contenidos </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#enunciado class=md-nav__link> Enunciado </a> </li> <li class=md-nav__item> <a href=#teoria class=md-nav__link> Teoría </a> </li> <li class=md-nav__item> <a href=#en-la-tdr-steam class=md-nav__link> En la TdR STEAM </a> </li> <li class=md-nav__item> <a href=#programando-el-reto class=md-nav__link> Programando el reto </a> <nav class=md-nav aria-label="Programando el reto"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#thingspeak class=md-nav__link> Thingspeak </a> </li> <li class=md-nav__item> <a href=#arduinoblocks class=md-nav__link> ArduinoBlocks </a> </li> <li class=md-nav__item> <a href=#visualizacion-de-datos class=md-nav__link> Visualización de datos </a> </li> <li class=md-nav__item> <a href=#visualizacion-de-datos-en-smartphone-o-similar class=md-nav__link> Visualización de datos en smartphone o similar </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#actividades-de-ampliacion class=md-nav__link> Actividades de ampliación </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=reto-15-iot-wifi>Reto-15. IoT (WiFi)<a class=headerlink href=#reto-15-iot-wifi title="Permanent link">&para;</a></h1> <h2 id=enunciado>Enunciado<a class=headerlink href=#enunciado title="Permanent link">&para;</a></h2> <p>En este reto vamos a hablar de como comunicar nuestra placa TdR STEAM con internet y de como enviar datos medidos localmente a la nube, empezando así a trabajar el Internet de las Cosas. El objeto no es profundizar en conceptos técnicos como Broker, MQTT, Mosquitto, etc. Vamos a limitarnos a aprender a subir unos datos concretos que no nos harán expertos en el tema, pero que será un primer paso.</p> <h2 id=teoria>Teoría<a class=headerlink href=#teoria title="Permanent link">&para;</a></h2> <p>Se recomienda encarecidamente leer el apartado <a href=./docs/IoT_basico.md>Teoría básica de IoT</a> de este mismo tutorial</p> <h2 id=en-la-tdr-steam>En la TdR STEAM<a class=headerlink href=#en-la-tdr-steam title="Permanent link">&para;</a></h2> <p><strong><font color=red>MUY IMPORTANTE</font></strong>: recordar que la placa TdR STEAM ya realiza el cruzamiento de conexiones entre Rx y Tx.</p> <p><center></p> <table> <thead> <tr> <th align=center>Tx-Rx en la TdR STEAM</th> </tr> </thead> <tbody> <tr> <td align=center><img alt="Tx-Rx en la TdR STEAM" src=../img/img/Reto-14/Rx-Tx-TdR.png></td> </tr> </tbody> </table> <p></center></p> <h2 id=programando-el-reto>Programando el reto<a class=headerlink href=#programando-el-reto title="Permanent link">&para;</a></h2> <p>Para poder visualizar los datos enviados desde la placa Imagina TdR STEAM utilizaremos el programa ThingSpeak y la aplicación ThingView. Por tanto, hemos de preparar los siguientes programas:</p> <ul> <li>ArduinoBlocks: programa de recogida y envío de datos.</li> <li>ThingSpeak: programa para ver los datos en el ordenador a través Internet.</li> <li>ThingView: aplicación para ver los datos en el teléfono móvil.</li> </ul> <h3 id=thingspeak>Thingspeak<a class=headerlink href=#thingspeak title="Permanent link">&para;</a></h3> <p>Una vez creada la cuenta en ThingSpeak tenemos que apuntar los siguientes datos:</p> <ul> <li>Channel ID: referencia de nuestro dispositivo.</li> <li>Author: referencia del autor del dispositivo.</li> </ul> <p>Estos datos los tendremos disponibles cuando creemos nuestro primer canal.</p> <p><center></p> <table> <thead> <tr> <th align=center>Perfil de la cuenta creada en Thingspeak</th> </tr> </thead> <tbody> <tr> <td align=center><img alt="Perfil de la cuenta creada en Thingspeak" src=../img/img/Reto-15/perfil-thing.png></td> </tr> </tbody> </table> <p></center></p> <p>Si ahora nos dirigimos al menú "Channels" y escogemos "My Channels" entraremos en la página de creación de un canal. En la parte superior de la página es donde ponemos nombre al canal y establecemos los campos que vamos a usar, como ejemplo tenemos el de la imagen siguiente:</p> <p><center></p> <table> <thead> <tr> <th align=center>Parte 1 de la creación de un canal</th> </tr> </thead> <tbody> <tr> <td align=center><img alt="Parte 1 de la creación de un canal" src=../img/img/Reto-15/crear-canal1.png></td> </tr> </tbody> </table> <p></center></p> <p>Si avanzamos hacía abajo en esta página podemos seguir cumplimentando datos de nuestro canal, como vemos en la imagen siguiente:</p> <p><center></p> <table> <thead> <tr> <th align=center>Parte 2 de la creación de un canal</th> </tr> </thead> <tbody> <tr> <td align=center><img alt="Parte 2 de la creación de un canal" src=../img/img/Reto-15/crear-canal2.png></td> </tr> </tbody> </table> <p></center></p> <p>Activar la localización y poner las coordenadas hará que, posteriormente lo veremos, aparezca la localización puesta en un mapa. Algo similar sucede con el vídeo enlazado. Si damos a guardar se nos mostrará una pantalla similar a la siguiente, donde podemos ver los datos del canal Reto-15.</p> <p><center></p> <table> <thead> <tr> <th align=center>Aspecto del canal recien creado</th> </tr> </thead> <tbody> <tr> <td align=center><img alt="Aspecto del canal recien creado" src=../img/img/Reto-15/canal-creado.png></td> </tr> </tbody> </table> <p></center></p> <p>Como vemos este canal es privado y solamente se ha creado para mostrar las capturas que aquí se están mostrando y por lo tanto no será un canal accesible en el futuro.</p> <p>En la pestaña “API Keys” vamos a tener disponibles los datos con los códigos identificativos para escribir en el canal y para leer el canal, tal y como vemos en la imagen siguiente. Estos datos los tendremos que usar posteriormente en ArduinoBlocks.</p> <p><center></p> <table> <thead> <tr> <th align=center>API-Keys</th> </tr> </thead> <tbody> <tr> <td align=center><img alt=API-Keys src=../img/img/Reto-15/api-keys.png></td> </tr> </tbody> </table> <p></center></p> <p>Con esto finalizamos la configuración de Thingspeak aunque hay otras muchas cosas que se pueden hacer con el broker.</p> <h3 id=arduinoblocks>ArduinoBlocks<a class=headerlink href=#arduinoblocks title="Permanent link">&para;</a></h3> <p>Una vez creado el canal en el broker ya estamos en condiciones de preparar el programa de ArduinoBlocks que envíe los datos del sensor DHT11 a la nube vía WiFi. Para ello en el bloque "Inicializar" tenemos que configurar los diferentes campos según vemos en la imagen siguiente:</p> <p><center></p> <table> <thead> <tr> <th align=center>Configuración del bloque Inicializar</th> </tr> </thead> <tbody> <tr> <td align=center><img alt="Configuración del bloque Inicializar" src=../img/img/Reto-15/config-inicializar.png></td> </tr> </tbody> </table> <p></center></p> <p>Una vez configurada la conexión vamos a implementar dos funciones una para leer los sensores y otra para subir los datos a la nube.</p> <p>En la imagen siguiente vemos la programación de la función leer sensores, que lógicamente va a consistir en leer los datos de humedad y temperatura del sensor DHT11 y guardarlos en sendas variables.</p> <p><center></p> <table> <thead> <tr> <th align=center>Función leer sensor DHT11</th> </tr> </thead> <tbody> <tr> <td align=center><img alt="Función leer sensor DHT11" src=../img/img/Reto-15/func-leer-sensor-DHT11.png></td> </tr> </tbody> </table> <p></center></p> <p>El bloque a utilizar lo encontramos en el menú MQTT de comunicaciones y tiene el aspecto de la imagen siguiente:</p> <p><center></p> <table> <thead> <tr> <th align=center>Bloque para publicar en MQTT</th> </tr> </thead> <tbody> <tr> <td align=center><img alt="Bloque para publicar en MQTT" src=../img/img/Reto-15/publicar-inicial.png></td> </tr> </tbody> </table> <p></center></p> <p>En tema debemos colocar el bloque "publicar" Thingspeak, que nos llevaría a tener el siguiente estado de programación:</p> <p><center></p> <table> <thead> <tr> <th align=center>El bloque publicar de Thingspeak</th> </tr> </thead> <tbody> <tr> <td align=center><img alt="El bloque publicar de Thingspeak" src=../img/img/Reto-15/publicar-con-tema.png></td> </tr> </tbody> </table> <p></center></p> <p>A continuación, configuraremos la publicación de los datos con la función subir datos a la nube y para ello debemos localizar:</p> <ul> <li>Channel ID: identificador de nuestro canal en ThingSpeak.</li> <li>Write API Key: contraseña de escritura o código para enviar los datos a ThingSpeak.</li> </ul> <p>Estos datos los hemos de poner en cada bloque que pongamos de "Publicar Tema" y debemos hacer corresponder el campo Field de ArduinoBlocks con el de Thingspeak. En la imagen siguiente vemos el aspecto de la función subir-datos.</p> <p><center></p> <table> <thead> <tr> <th align=center>Función subir datos</th> </tr> </thead> <tbody> <tr> <td align=center><img alt="Función subir datos" src=../img/img/Reto-15/Funcion-subir-datos.png></td> </tr> </tbody> </table> <p></center></p> <p>Lo único que resta para finalizar el programa es llamar a las funciones dentro del bucle. El aspecto final del programa lo vemos en la imagen siguiente:</p> <p><center></p> <table> <thead> <tr> <th align=center>Programa del Reto 15</th> </tr> </thead> <tbody> <tr> <td align=center><img alt="Programa del Reto 15" src=../img/img/Reto-15/Reto-15.png></td> </tr> </tbody> </table> <p></center></p> <p>Cuando estamos trabajando con WiFi los bloques "Esperar" ya que durante la espera la conexión debe seguir realizando sus tareas y puede llegar el momento en que, si los usamos, la conexión se corte o moience a hacer cosas extrañas. Por eso es recomendable utilizar el bloque "Ejecutar cada" que vemos en la imagen anterior y evitar así posibles bloqueos en el micro. Es conveniente leer el apartado "Tiempo" <a href=https://docs.google.com/document/u/1/d/e/2PACX-1vQSrOKHpbLQHVbGFdAvp7DcndoftoHDI20nvwGMaxu_7bGc1bUCmi4U6DZrJWRSudc2iXBg43QMuzCT/pub>ArduinoBlocks - FreeBook</a> así como su Anexo I: Bloques incompatibles con bloqueos de tiempo.</p> <p>El bloque "Ejecutar cada" se establece a 16 segundos y esto es importante porque la versión gratuita de ThingSpeak sólo permite subir datos cada 15 segundos (<a href=https://thingspeak.com/pages/license_faq>ThingSpeak™ Licensing FAQ</a>) y le damos un segundo mas porque justo los 15 segundos en alguna ocasión me ha generado algún problema. <strong>¡Ya hemos configurado ArduinoBlocks!</strong></p> <p>La programación del reto sin configurar los distintos campos está en el programa <a href=http://www.arduinoblocks.com/web/project/655980>Reto-15</a>.</p> <h3 id=visualizacion-de-datos>Visualización de datos<a class=headerlink href=#visualizacion-de-datos title="Permanent link">&para;</a></h3> <p>Una vez hecho esto ya podemos subir el programa a la placa y al cabo de unos segundos empezaremos a ver los primeros datos subidos en los dos campos del canal de ThingSpeak en la pestaña "Private View" de la web, tal y como muestra la imagen siguiente:</p> <p><center></p> <table> <thead> <tr> <th align=center>Vista de Private View en la web de Thingspeak</th> </tr> </thead> <tbody> <tr> <td align=center><img alt="Vista de Private View en la web de Thingspeak" src=../img/img/Reto-15/Datos-web-TS.png></td> </tr> </tbody> </table> <p></center></p> <h3 id=visualizacion-de-datos-en-smartphone-o-similar>Visualización de datos en smartphone o similar<a class=headerlink href=#visualizacion-de-datos-en-smartphone-o-similar title="Permanent link">&para;</a></h3> <p>MATLAB a través de su servidor (broker) Thingspeak ofrece varias aplicaciones para dispositivos smartphone. En la imagen siguiente vemos el resultado de una búsqueda en un dispositivo Android en Play Store.</p> <p><center></p> <table> <thead> <tr> <th align=center>Thingspeak en Play Store</th> </tr> </thead> <tbody> <tr> <td align=center><img alt="Thingspeak en Play Store" src=../img/img/Reto-15/play-store.png></td> </tr> </tbody> </table> <p></center></p> <p>Nos centraremos en las dos destacadas en la imagen anterior.</p> <ul> <li><strong>ThingView</strong> Una vez instalada la App en nuestro smartphone podemos añadir los canales que deseemos, simplemente haciendo clic sobre el signo más y dando el identificador del canal. En la imagen siguiente observamos el canal del Reto 15 creado para este caso.</li> </ul> <p><center></p> <table> <thead> <tr> <th align=center>ThingView con canal agregado</th> </tr> </thead> <tbody> <tr> <td align=center><img alt="ThingView con canal agregado" src=../img/img/Reto-15/ThingView-con-canal-agregado.jpeg></td> </tr> </tbody> </table> <p></center></p> <p>En esta otra imagen vemos la visualización de datos del canal en ThingView.</p> <p><center></p> <table> <thead> <tr> <th align=center>Visulizando datos en ThingView</th> </tr> </thead> <tbody> <tr> <td align=center><img alt="Visulizando datos en ThingView" src=../img/img/Reto-15/Visulizando-datos-en-ThingView.jpeg></td> </tr> </tbody> </table> <p></center></p> <h2 id=actividades-de-ampliacion>Actividades de ampliación<a class=headerlink href=#actividades-de-ampliacion title="Permanent link">&para;</a></h2> <p><strong>R15.A1</strong>: (No solucionada) Estudiar la funcionalidad de las pestañas y botones que se ven en la imagen siguiente y probar, realizando una memoria al estilo de los retos de este tutorial, al menos sobre los tres destacados.</p> <p><center></p> <table> <thead> <tr> <th align=center>Actividad 1 del reto 15</th> </tr> </thead> <tbody> <tr> <td align=center><img alt="Actividad 1 del reto 15" src=../img/img/Reto-15/R15.A1.png></td> </tr> </tbody> </table> <p></center></p> <p><strong>R15.A2</strong>: (No solucionada) Instalar la aplicación ThingView y realizar la visualización de datos de al menos un canal creado para esta actividad.</p> <p><strong>R15.A3:Widget</strong>: (No solucionada) La segunda opción de descarga es una microaplicación widget para la pantalla de nuestro móvil que nos va a permitir estar viendo dos de las variables que tengamos en nuestro canal. En este caso, además del número de canal debemos conocer la API key de lectura. El widget permite establecer alarmas cuando se superan, por encima o por abajo, los valores de la variable establecidos. Añadir el widget al smartphone y experimentar sus diferentes opciones.</p> </article> </div> </div> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Pie> <a href=../R14/ class="md-footer__link md-footer__link--prev" aria-label="Anterior: Reto-14. Bluetooth" rel=prev> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </div> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Anterior </span> Reto-14. Bluetooth </div> </div> </a> <a href=../retos/ class="md-footer__link md-footer__link--next" aria-label="Siguiente: Todos los programas de los retos" rel=next> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Siguiente </span> Todos los programas de los retos </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2022 - 2030 Federico Coca </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "..", "features": [], "translations": {"clipboard.copy": "Copiar al portapapeles", "clipboard.copied": "Copiado al portapapeles", "search.config.lang": "es", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "B\u00fasqueda", "search.result.placeholder": "Teclee para comenzar b\u00fasqueda", "search.result.none": "No se encontraron documentos", "search.result.one": "1 documento encontrado", "search.result.other": "# documentos encontrados", "search.result.more.one": "1 m\u00e1s en esta p\u00e1gina", "search.result.more.other": "# m\u00e1s en esta p\u00e1gina", "search.result.term.missing": "Falta", "select.version.title": "Seleccionar versi\u00f3n"}, "search": "../assets/javascripts/workers/search.22074ed6.min.js"}</script> <script src=../assets/javascripts/bundle.960e086b.min.js></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script> </body> </html>